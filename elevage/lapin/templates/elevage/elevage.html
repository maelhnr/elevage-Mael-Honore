{% extends 'base.html' %}

{% block title %}Ã‰levage de {{ elevage.nom_joueur }}{% endblock %}

{% block content %}

<div class="mb-4">
    <h1>Ã‰levage de {{ elevage.nom_joueur }} - Tour nÂ°{{ elevage.tour }}</h1>
    <p>
        <strong>Nourriture :</strong> {{ elevage.quantite_nourriture }} g<br>
        <strong>Cages :</strong> {{ elevage.nombre_cages }}<br>
        <strong>Argent :</strong> {{ elevage.argent }} â‚¬
    </p>
</div>

{% if resultats_tour %}
    <div class="alert alert-info">
        <h2>RÃ©sumÃ© du tour</h2>
        {% if resultats_tour.morts_faim %}
            <p><strong>Morts de faim :</strong> {{ resultats_tour.morts_faim|length }}</p>
        {% endif %}
        {% if resultats_tour.morts_maladie %}
            <p><strong>Morts par maladie :</strong> {{ resultats_tour.morts_maladie|length }}</p>
        {% endif %}
        {% if resultats_tour.naissances %}
            <p><strong>Naissances :</strong> {{ resultats_tour.naissances|length }}</p>
        {% endif %}
        {% if lapins_vendus_m or lapins_vendus_f %}
            <p><strong>Lapins vendus :</strong> {{ lapins_vendus_m }} mÃ¢le(s), {{ lapins_vendus_f }} femelle(s)</p>
        {% endif %}
        {% if not resultats_tour.morts_faim and not resultats_tour.naissances and not resultats_tour.morts_maladie and not lapins_vendus_m and not lapins_vendus_f %}
            <p><em>Aucun Ã©vÃ©nement notable ce tour.</em></p>
        {% endif %}
    </div>
{% endif %}

{% if not fin_du_jeu %}
    <h2>Lapins prÃ©sents ({{ individus|length }})</h2>
    <ul class="list-group mb-4">
        {% for individu in individus %}
            <li class="list-group-item">
                Sexe : {{ individu.get_sexe_display }} | Ã‚ge : {{ individu.age }} mois{% if individu.etat == 'G' %} | Gravide{% endif %}
            </li>
        {% empty %}
            <li class="list-group-item">Aucun individu dans cet Ã©levage.</li>
        {% endfor %}
    </ul>

    <h2>Actions du tour</h2>
    <form method="post" class="mb-5">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-primary mt-2">Valider le tour</button>
    </form>
{% else %}
    <div class="alert alert-danger">
        <h2>ğŸ’€ Fin de l'Ã©levage</h2>
        <p>Malheureusement, tous vos lapins sont morts ou ont Ã©tÃ© vendus... ğŸ‡</p>
        <p>Vous avez atteint le <strong>tour {{ elevage.tour }}</strong>.</p>
        <p><strong>Score final :</strong></p>
        <ul>
            <li>Argent restant : {{ elevage.argent }} â‚¬</li>
            <li>Nourriture restante : {{ elevage.quantite_nourriture }} g</li>
            <li>Cages restantes : {{ elevage.nombre_cages }}</li>
        </ul>
        <a href="{% url 'nouveau_elevage' %}" class="btn btn-success mt-2">ğŸ” Recommencer un Ã©levage</a>
        <a href="{% url 'liste_elevages' %}" class="btn btn-secondary mt-2">â† Retour Ã  la liste</a>
    </div>
{% endif %}

{% endblock %}
