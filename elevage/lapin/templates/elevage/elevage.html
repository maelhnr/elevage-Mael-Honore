{% if not fin_du_jeu %}
    <h1>Élevage de {{ elevage.nom_joueur }} - Tour n°{{ elevage.tour }}</h1>

    <p>
        Nourriture : {{ elevage.quantite_nourriture }} g<br>
        Cages : {{ elevage.nombre_cages }}<br>
        Argent : {{ elevage.argent }} €
    </p>
{% endif %}

{% if resultats_tour %}
    <div class="tour-resultats">
        <h2>Résumé du tour</h2>

        {% if resultats_tour.morts_faim %}
            <p><strong>Morts de faim :</strong> {{ resultats_tour.morts_faim|length }}</p>
        {% endif %}

        {% if resultats_tour.morts_maladie %}
            <p><strong>Morts par maladie :</strong> {{ resultats_tour.morts_maladie|length }}</p>
        {% endif %}

        {% if resultats_tour.naissances %}
            <p><strong>Naissances :</strong> {{ resultats_tour.naissances|length }}</p>
        {% endif %}
    </div>
{% endif %}
{% if not fin_du_jeu %}
    <h2>Lapins présents ({{ individus|length }})</h2>
    <ul>
        {% for individu in individus %}
            <li>
                Sexe : {{ individu.get_sexe_display }} |
                Âge : {{ individu.age }} mois
                {% if individu.etat == 'G' %}| Gravide{% endif %}
            </li>
        {% empty %}
            <li>Aucun individu dans cet élevage.</li>
        {% endfor %}
    </ul>
{% endif %}

{% if fin_du_jeu %}
    <div style="padding: 2em; background-color: #ffe6e6; border: 2px solid red; border-radius: 10px; margin-top: 2em;">
        <h2>💀 Fin de l'élevage</h2>
        <p>Malheureusement, tous vos lapins sont morts ou ont été vendus... 🐇</p>
        <p>Vous avez atteint le <strong>tour {{ elevage.tour }}</strong>.</p>
        <p><strong>Score final :</strong></p>
        <ul>
            <li>Argent restant : {{ elevage.argent }} €</li>
            <li>Nourriture restante : {{ elevage.quantite_nourriture }} g</li>
            <li>Cages restantes : {{ elevage.nombre_cages }}</li>
        </ul>
        <a href="{% url 'nouveau_elevage' %}" style="display: inline-block; margin-top: 1em; padding: 0.5em 1em; background-color: #28a745; color: white; border-radius: 5px;">🔁 Recommencer un élevage</a>
        <br><br>
        <a href="{% url 'liste_elevages' %}">← Retour à la liste</a>
    </div>
{% else %}
    <h2>Actions du tour</h2>

    {% if form.non_field_errors %}
        <div style="color: red; margin-bottom: 1em;">
            {% for error in form.non_field_errors %}
                <p><strong>{{ error }}</strong></p>
            {% endfor %}
        </div>
    {% endif %}

    <form method="post">
        {% csrf_token %}
        <p>{{ form.lapins_males_vendus.label_tag }} {{ form.lapins_males_vendus }}</p>
        <p>{{ form.lapins_femelles_vendus.label_tag }} {{ form.lapins_femelles_vendus }}</p>
        <p>{{ form.nourriture_achetee.label_tag }} {{ form.nourriture_achetee }}</p>
        <p>{{ form.cages_achetees.label_tag }} {{ form.cages_achetees }}</p>
        <button type="submit">Valider le tour</button>
    </form>
{% endif %}
